local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "Bro_broaScriptHub"
ScreenGui.Parent = game:GetService("CoreGui")

-- Initialize storage
if not shared.Bro_broaScripts then
    shared.Bro_broaScripts = {}
end

-- Main container frame (mobile-optimized)
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0.9, 0, 0.8, 0)  -- Larger for mobile
MainFrame.Position = UDim2.new(0.05, 0, 0.1, 0)  -- Centered with margins
MainFrame.BackgroundColor3 = Color3.new(0.8, 0.8, 0.8)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Parent = ScreenGui

-- Title bar with movement controls
local TitleBar = Instance.new("Frame")
TitleBar.Size = UDim2.new(1, 0, 0.08, 0)  -- Taller for mobile
TitleBar.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
TitleBar.Parent = MainFrame

local TitleText = Instance.new("TextLabel")
TitleText.Size = UDim2.new(0.7, -50, 1, 0)
TitleText.Position = UDim2.new(0, 10, 0, 0)
TitleText.Text = "Bro_broa Script Hub"
TitleText.BackgroundTransparency = 1
TitleText.TextColor3 = Color3.new(1, 1, 1)
TitleText.TextXAlignment = Enum.TextXAlignment.Left
TitleText.Font = Enum.Font.SourceSansBold
TitleText.TextSize = 18  -- Larger text
TitleText.Parent = TitleBar

-- Movement lock button (mobile-optimized)
local LockBtn = Instance.new("TextButton")
LockBtn.Size = UDim2.new(0, 40, 1, 0)  -- Wider for mobile
LockBtn.Position = UDim2.new(0.7, -40, 0, 0)
LockBtn.Text = "ðŸ”“"
LockBtn.BackgroundColor3 = Color3.new(0.4, 0.4, 0.4)
LockBtn.TextColor3 = Color3.new(1, 1, 1)
LockBtn.Font = Enum.Font.SourceSans
LockBtn.TextSize = 20  -- Larger text
LockBtn.Parent = TitleBar

-- Close button (mobile-optimized)
local CloseBtn = Instance.new("TextButton")
CloseBtn.Size = UDim2.new(0, 40, 1, 0)  -- Wider for mobile
CloseBtn.Position = UDim2.new(1, -40, 0, 0)
CloseBtn.Text = "X"
CloseBtn.BackgroundColor3 = Color3.new(0.8, 0.2, 0.2)
CloseBtn.TextColor3 = Color3.new(1, 1, 1)
CloseBtn.Font = Enum.Font.SourceSansBold
CloseBtn.TextSize = 20  -- Larger text
CloseBtn.Parent = TitleBar

-- Create tab system (mobile-optimized)
local Tabs = Instance.new("Frame")
Tabs.Size = UDim2.new(1, 0, 0.1, 0)  -- Taller tabs
Tabs.BackgroundColor3 = Color3.new(0.4, 0.4, 0.4)
Tabs.BorderSizePixel = 0
Tabs.Position = UDim2.new(0, 0, 0.08, 0)
Tabs.Parent = MainFrame

local ScriptEditorTab = Instance.new("TextButton")
ScriptEditorTab.Size = UDim2.new(0.45, 0, 1, 0)  -- Wider tabs
ScriptEditorTab.Position = UDim2.new(0.02, 0, 0, 0)
ScriptEditorTab.Text = "EDITOR"
ScriptEditorTab.BackgroundColor3 = Color3.new(0.2, 0.4, 0.6)
ScriptEditorTab.TextColor3 = Color3.new(1, 1, 1)
ScriptEditorTab.Font = Enum.Font.SourceSansBold
ScriptEditorTab.TextSize = 16  -- Larger text
ScriptEditorTab.Parent = Tabs

local ScriptListTab = Instance.new("TextButton")
ScriptListTab.Size = UDim2.new(0.45, 0, 1, 0)  -- Wider tabs
ScriptListTab.Position = UDim2.new(0.53, 0, 0, 0)
ScriptListTab.Text = "LIBRARY"
ScriptListTab.BackgroundColor3 = Color3.new(0.5, 0.5, 0.5)
ScriptListTab.TextColor3 = Color3.new(1, 1, 1)
ScriptListTab.Font = Enum.Font.SourceSansBold
ScriptListTab.TextSize = 16  -- Larger text
ScriptListTab.Parent = Tabs

-- Script Editor Page
local EditorPage = Instance.new("Frame")
EditorPage.Size = UDim2.new(1, 0, 0.82, 0)
EditorPage.Position = UDim2.new(0, 0, 0.18, 0)
EditorPage.BackgroundTransparency = 1
EditorPage.Visible = true
EditorPage.Parent = MainFrame

-- Editor label
local EditorLabel = Instance.new("TextLabel")
EditorLabel.Size = UDim2.new(0.95, 0, 0.07, 0)  -- Taller label
EditorLabel.Position = UDim2.new(0.025, 0, 0, 0)
EditorLabel.Text = "SCRIPT EDITOR:"
EditorLabel.BackgroundTransparency = 1
EditorLabel.TextColor3 = Color3.new(0.1, 0.1, 0.1)
EditorLabel.TextXAlignment = Enum.TextXAlignment.Left
EditorLabel.Font = Enum.Font.SourceSansBold
EditorLabel.TextSize = 16  -- Larger text
EditorLabel.Parent = EditorPage

-- Script editor box (mobile-optimized)
local ScriptBox = Instance.new("ScrollingFrame")
ScriptBox.Size = UDim2.new(0.95, 0, 0.65, 0)  -- Taller for mobile
ScriptBox.Position = UDim2.new(0.025, 0, 0.08, 0)
ScriptBox.BackgroundColor3 = Color3.new(1, 1, 1)
ScriptBox.BorderSizePixel = 1
ScriptBox.BorderColor3 = Color3.new(0.7, 0.7, 0.7)
ScriptBox.CanvasSize = UDim2.new(0, 0, 5, 0)
ScriptBox.ScrollBarThickness = 14  -- Thicker scrollbar
ScriptBox.ScrollBarImageColor3 = Color3.new(0.2, 0.4, 0.6)
ScriptBox.Parent = EditorPage

local TextBox = Instance.new("TextBox")
TextBox.Size = UDim2.new(1, 0, 1, 0)
TextBox.BackgroundTransparency = 1
TextBox.Text = "-- Type your script here\nprint('Hello from Bro_broa!')"
TextBox.TextWrapped = true
TextBox.TextXAlignment = Enum.TextXAlignment.Left
TextBox.TextYAlignment = Enum.TextYAlignment.Top
TextBox.TextColor3 = Color3.new(0.1, 0.1, 0.1)
TextBox.Font = Enum.Font.Code
TextBox.TextSize = 16  -- Larger text for mobile
TextBox.MultiLine = true
TextBox.ClearTextOnFocus = false
TextBox.Parent = ScriptBox

-- Button container (mobile-optimized)
local ButtonContainer = Instance.new("Frame")
ButtonContainer.Size = UDim2.new(0.95, 0, 0.2, 0)  -- Taller buttons
ButtonContainer.Position = UDim2.new(0.025, 0, 0.75, 0)
ButtonContainer.BackgroundTransparency = 1
ButtonContainer.Parent = EditorPage

-- Action buttons (mobile-optimized)
local ExecuteBtn = Instance.new("TextButton")
ExecuteBtn.Size = UDim2.new(0.3, 0, 1, 0)  -- Full height
ExecuteBtn.Position = UDim2.new(0, 0, 0, 0)
ExecuteBtn.Text = "RUN"
ExecuteBtn.BackgroundColor3 = Color3.new(0.2, 0.6, 0.3)
ExecuteBtn.TextColor3 = Color3.new(1, 1, 1)
ExecuteBtn.Font = Enum.Font.SourceSansBold
ExecuteBtn.TextSize = 18  -- Larger text
ExecuteBtn.Parent = ButtonContainer

local ClearBtn = Instance.new("TextButton")
ClearBtn.Size = UDim2.new(0.3, 0, 1, 0)  -- Full height
ClearBtn.Position = UDim2.new(0.35, 0, 0, 0)
ClearBtn.Text = "CLEAR"
ClearBtn.BackgroundColor3 = Color3.new(0.8, 0.4, 0.2)
ClearBtn.TextColor3 = Color3.new(1, 1, 1)
ClearBtn.Font = Enum.Font.SourceSansBold
ClearBtn.TextSize = 18  -- Larger text
ClearBtn.Parent = ButtonContainer

local SaveBtn = Instance.new("TextButton")
SaveBtn.Size = UDim2.new(0.3, 0, 1, 0)  -- Full height
SaveBtn.Position = UDim2.new(0.7, 0, 0, 0)
SaveBtn.Text = "SAVE"
SaveBtn.BackgroundColor3 = Color3.new(0.3, 0.4, 0.8)
SaveBtn.TextColor3 = Color3.new(1, 1, 1)
SaveBtn.Font = Enum.Font.SourceSansBold
SaveBtn.TextSize = 18  -- Larger text
SaveBtn.Parent = ButtonContainer

-- Script Library Page
local LibraryPage = Instance.new("Frame")
LibraryPage.Size = UDim2.new(1, 0, 0.82, 0)
LibraryPage.Position = UDim2.new(0, 0, 0.18, 0)
LibraryPage.BackgroundTransparency = 1
LibraryPage.Visible = false
LibraryPage.Parent = MainFrame

-- Library label
local LibraryLabel = Instance.new("TextLabel")
LibraryLabel.Size = UDim2.new(0.95, 0, 0.07, 0)  -- Taller label
LibraryLabel.Position = UDim2.new(0.025, 0, 0, 0)
LibraryLabel.Text = "SCRIPT LIBRARY:"
LibraryLabel.BackgroundTransparency = 1
LibraryLabel.TextColor3 = Color3.new(0.1, 0.1, 0.1)
LibraryLabel.TextXAlignment = Enum.TextXAlignment.Left
LibraryLabel.Font = Enum.Font.SourceSansBold
LibraryLabel.TextSize = 16  -- Larger text
LibraryLabel.Parent = LibraryPage

-- Script list container
local ScriptListContainer = Instance.new("Frame")
ScriptListContainer.Size = UDim2.new(0.95, 0, 0.85, 0)
ScriptListContainer.Position = UDim2.new(0.025, 0, 0.08, 0)
ScriptListContainer.BackgroundColor3 = Color3.new(1, 1, 1)
ScriptListContainer.BorderSizePixel = 1
ScriptListContainer.BorderColor3 = Color3.new(0.7, 0.7, 0.7)
ScriptListContainer.ClipsDescendants = true
ScriptListContainer.Parent = LibraryPage

local ScriptList = Instance.new("ScrollingFrame")
ScriptList.Size = UDim2.new(1, -20, 1, 0) -- Make space for slider
ScriptList.Position = UDim2.new(0, 0, 0, 0)
ScriptList.BackgroundTransparency = 1
ScriptList.CanvasSize = UDim2.new(0, 0, 0, 0)
ScriptList.ScrollBarThickness = 0
ScriptList.Parent = ScriptListContainer

-- Predefined scripts
local PredefinedScripts = {
    ["Bro_broa GUI"] = {
        code = [[
            -- Creator by bro_broa3
            loadstring(game:HttpGet("https://raw.githubusercontent.com/Bro-broa3/Bro_broa-scripts/main/Bro_broa%20gui%205.0"))()
        ]],
        creator = "bro_broa3"
    },
    ["Speed Boost"] = {
        code = [[
            game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = 50
            print("Speed boosted!")
        ]],
        creator = "System"
    },
    ["Infinite Yield"] = {
        code = [[
            loadstring(game:HttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source"))()
        ]],
        creator = "Edge"
    }
}

-- Save instruction label
local SaveInstruction = Instance.new("TextLabel")
SaveInstruction.Size = UDim2.new(0.9, 0, 0.1, 0)
SaveInstruction.Position = UDim2.new(0.05, 0, 0.75, 0)
SaveInstruction.Text = "Tap SAVE in editor to add scripts"
SaveInstruction.TextColor3 = Color3.new(0.4, 0.4, 0.4)
SaveInstruction.BackgroundTransparency = 1
SaveInstruction.TextXAlignment = Enum.TextXAlignment.Center
SaveInstruction.Font = Enum.Font.SourceSans
SaveInstruction.TextSize = 16
SaveInstruction.Visible = false
SaveInstruction.Parent = LibraryPage

-- Custom slider components
local SliderTrack = Instance.new("Frame")
SliderTrack.Size = UDim2.new(0, 14, 1, 0)  -- Thicker for mobile
SliderTrack.Position = UDim2.new(1, -14, 0, 0)
SliderTrack.BackgroundColor3 = Color3.new(0.9, 0.9, 0.9)
SliderTrack.BorderSizePixel = 0
SliderTrack.Parent = ScriptListContainer

local SliderThumb = Instance.new("Frame")
SliderThumb.Size = UDim2.new(1, 0, 0.2, 0)
SliderThumb.Position = UDim2.new(0, 0, 0, 0)
SliderThumb.BackgroundColor3 = Color3.new(0.2, 0.4, 0.6)
SliderThumb.BorderSizePixel = 0
SliderThumb.Parent = SliderTrack

-- Custom slider functionality
local function updateSlider()
    local visibleHeight = ScriptList.AbsoluteSize.Y
    local contentHeight = ScriptList.CanvasSize.Y.Offset
    local scrollPosition = ScriptList.CanvasPosition.Y
    
    if contentHeight > visibleHeight then
        SliderTrack.Visible = true
        local thumbHeight = math.max(30, visibleHeight * (visibleHeight / contentHeight))  -- Minimum 30 pixels
        local thumbPosition = (scrollPosition / (contentHeight - visibleHeight)) * (visibleHeight - thumbHeight)
        
        SliderThumb.Size = UDim2.new(1, 0, 0, thumbHeight)
        SliderThumb.Position = UDim2.new(0, 0, 0, thumbPosition)
    else
        SliderTrack.Visible = false
    end
end

-- Populate script library
local function populateScriptList()
    ScriptList:ClearAllChildren()
    local yPos = 10
    
    -- Combine all scripts (predefined + user saved)
    local AllScripts = {}
    for name, data in pairs(PredefinedScripts) do
        AllScripts[name] = data
    end
    for name, data in pairs(shared.Bro_broaScripts) do
        AllScripts[name] = data
    end
    
    -- Show instruction if no user scripts
    SaveInstruction.Visible = (next(shared.Bro_broaScripts) == nil)
    
    -- Create script cards
    for name, data in pairs(AllScripts) do
        local btnFrame = Instance.new("Frame")
        btnFrame.Size = UDim2.new(0.95, 0, 0, 70)  -- Taller for mobile
        btnFrame.Position = UDim2.new(0.025, 0, 0, yPos)
        btnFrame.BackgroundColor3 = data.creator == "You" and Color3.new(0.9, 0.95, 0.9) or Color3.new(0.9, 0.9, 0.9)
        btnFrame.BorderSizePixel = 1
        btnFrame.BorderColor3 = Color3.new(0.8, 0.8, 0.8)
        btnFrame.Parent = ScriptList
        
        local scriptName = Instance.new("TextLabel")
        scriptName.Size = UDim2.new(0.7, 0, 0.5, 0)
        scriptName.Position = UDim2.new(0.05, 0, 0.1, 0)
        scriptName.Text = name
        scriptName.TextColor3 = Color3.new(0.1, 0.1, 0.1)
        scriptName.TextXAlignment = Enum.TextXAlignment.Left
        scriptName.BackgroundTransparency = 1
        scriptName.Font = Enum.Font.SourceSansBold
        scriptName.TextSize = 18  -- Larger text
        scriptName.Parent = btnFrame
        
        local creatorLabel = Instance.new("TextLabel")
        creatorLabel.Size = UDim2.new(0.7, 0, 0.4, 0)
        creatorLabel.Position = UDim2.new(0.05, 0, 0.6, 0)
        creatorLabel.Text = "By: " .. data.creator
        creatorLabel.TextColor3 = data.creator == "You" and Color3.new(0, 0.5, 0) or Color3.new(0.4, 0.4, 0.4)
        creatorLabel.TextXAlignment = Enum.TextXAlignment.Left
        creatorLabel.TextSize = 16  -- Larger text
        creatorLabel.BackgroundTransparency = 1
        creatorLabel.Font = Enum.Font.SourceSans
        creatorLabel.Parent = btnFrame
        
        local loadBtn = Instance.new("TextButton")
        loadBtn.Size = UDim2.new(0.25, 0, 0.7, 0)
        loadBtn.Position = UDim2.new(0.73, 0, 0.15, 0)
        loadBtn.Text = "LOAD"
        loadBtn.BackgroundColor3 = Color3.new(0.3, 0.5, 0.8)
        loadBtn.TextColor3 = Color3.new(1, 1, 1)
        loadBtn.Font = Enum.Font.SourceSansBold
        loadBtn.TextSize = 16  -- Larger text
        loadBtn.Parent = btnFrame
        
        loadBtn.MouseButton1Click:Connect(function()
            TextBox.Text = data.code
            EditorPage.Visible = true
            LibraryPage.Visible = false
            ScriptEditorTab.BackgroundColor3 = Color3.new(0.2, 0.4, 0.6)
            ScriptListTab.BackgroundColor3 = Color3.new(0.5, 0.5, 0.5)
        end)
        
        yPos += 80  -- More spacing
    end
    
    ScriptList.CanvasSize = UDim2.new(0, 0, 0, yPos)
    updateSlider()
end

-- Button functionality
ExecuteBtn.MouseButton1Click:Connect(function()
    local success, err = pcall(function()
        loadstring(TextBox.Text)()
    end)
    if not success then
        warn("Execution error: "..err)
    end
end)

ClearBtn.MouseButton1Click:Connect(function()
    TextBox.Text = ""
end)

SaveBtn.MouseButton1Click:Connect(function()
    -- Simple save process for mobile
    local scriptName = "My Script " .. os.time()  -- Auto-generate name
    
    -- Save to shared storage
    shared.Bro_broaScripts[scriptName] = {
        code = TextBox.Text,
        creator = "You"
    }
    
    -- Refresh library and switch to it
    populateScriptList()
    EditorPage.Visible = false
    LibraryPage.Visible = true
    ScriptEditorTab.BackgroundColor3 = Color3.new(0.5, 0.5, 0.5)
    ScriptListTab.BackgroundColor3 = Color3.new(0.2, 0.4, 0.6)
    
    -- Show confirmation message
    local message = Instance.new("TextLabel")
    message.Size = UDim2.new(0.8, 0, 0.1, 0)
    message.Position = UDim2.new(0.1, 0, 0.45, 0)
    message.Text = "Script saved as: " .. scriptName
    message.BackgroundColor3 = Color3.new(0.2, 0.6, 0.3)
    message.TextColor3 = Color3.new(1, 1, 1)
    message.TextScaled = true
    message.ZIndex = 10
    message.Parent = LibraryPage
    
    -- Auto-remove message after 3 seconds
    delay(3, function()
        if message and message.Parent then
            message:Destroy()
        end
    end)
end)

-- Tab switching
ScriptEditorTab.MouseButton1Click:Connect(function()
    EditorPage.Visible = true
    LibraryPage.Visible = false
    ScriptEditorTab.BackgroundColor3 = Color3.new(0.2, 0.4, 0.6)
    ScriptListTab.BackgroundColor3 = Color3.new(0.5, 0.5, 0.5)
end)

ScriptListTab.MouseButton1Click:Connect(function()
    EditorPage.Visible = false
    LibraryPage.Visible = true
    ScriptEditorTab.BackgroundColor3 = Color3.new(0.5, 0.5, 0.5)
    ScriptListTab.BackgroundColor3 = Color3.new(0.2, 0.4, 0.6)
end)

CloseBtn.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

-- Movement lock toggle
local locked = false
LockBtn.MouseButton1Click:Connect(function()
    locked = not locked
    MainFrame.Active = not locked
    MainFrame.Draggable = not locked
    LockBtn.Text = locked and "ðŸ”’" or "ðŸ”“"
    LockBtn.BackgroundColor3 = locked and Color3.new(0.6, 0.2, 0.2) or Color3.new(0.4, 0.4, 0.4)
    TitleText.Text = locked and "Script Hub (LOCKED)" or "Script Hub (DRAGGING)"
end)

-- Initialize
populateScriptList()
